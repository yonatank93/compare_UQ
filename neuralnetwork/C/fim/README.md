# UQ loss Monte Carlo FIM last layer

The ensemble is generated by sampling the weights and biases of the last layer from a multivariate Gaussian distribution centered at the optimal training values.
The covariance of the distribution is calculated from the inverse of the Fisher information matrix (FIM).
The FIM is obtained by taking the expectation value of the Hessian of the log-posterior.
The log-likelihood is set to be proportional negative least-squares loss function, and the prior is a standard normal distribution.

Then, to compare the uncertainty obtained using the Monte Carlo FIM ensemble against other UQ methods, we propagate the uncertainty to some target quantities, as described below.


## Content and workflow

1. First, compute the FIM by using `fim_last_layer_bayes.ipynb` notebook.
2. Follow the calculation by installing the KIM model members of the emsemble using `python losstraj_install_uninstall.py install` command.
3. Uncertainty of the configuration energy per atom for the configurations in the test set.
   `uncertainty_accuracy_energies.ipynb` and `uncertainty_accuracy_energies.py` correspond to this calculation.
   The notebook has additional commands to plot the results.
4. Uncertainty of equilibrium lattice constant and cohesive energy for a monolayer graphene at 0~K.
   Use `uncertainty_latconst_ecoh.ipynb` to do this calculation.
5. Uncertainty of energy as a function of lattice parameter for a monolayer graphene at 0~K under uniform in-plane compression and stretching.
   Use `uncertainty_energy_vs_latconst.ipynb` to do this calculation.
6. Uncertainty of phonon dispersion for a monolayer graphene at 0~K along $\Gamma - M - K - \Gamma$ band path.
   The phonon calculation in `uncertainty_phonon_dispersion.ipynb` is done using ASE.
7. Uncertainty of finite temperature virial stress of graphene at 300~K.
   The ensemble calculation is done using `uncertainty_virial_stress_runmd.py` Python script, and `uncertainty_virial_stress_submitjobs.py` is used to submit the jobs to the supercomputer.
   Then, use `uncertainty_virial_stress.ipynb` to present the results.
