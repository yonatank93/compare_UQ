# UQ by random initialization

The ensemble is generated by randomly initializing the weights and biases prior to the training.
Then, for initial weights and biases values, we proceed with the training.
In practice, this is done by using different random seed in each training run.

Then, to compare the uncertainty obtained using random intialization ensemble against other UQ methods, we propagate the uncertainty to some target quantities, as described below.


## Content and workflow

1. The script `randinit_single_set.py` runs the training for a given random seed, and thus it will produce a single member of the ensemble.
   The main script to generate the entire ensemble is `randinit_submit_job.py`.
   This job iterates over different random seed, writes a slurm file, then submit the job to the super computer that runs `randinit_single_set.py` for each random seed.
   Thus, the end product is the entire ensemble.
2. Follow the calculation by installing the KIM model members of the emsemble using `python randinit_install_uninstall.py install` command.
3. Then, to reduce the number of files produce, e.g., if there is a limit of file count, run `python randinit_archive_saved_models.py`.
   This will combine and aarchive the saved models exported during the training for each ensemble.
   Running this command will create a file named `results/<partition>_partition/<ensemble_id>/models/models.tar.gz`, where `ensemble_id` is a number from 000 to 099.
4. Uncertainty of the configuration energy per atom for the configurations in the test set.
   `uncertainty_accuracy_energies.ipynb` and `uncertainty_accuracy_energies.py` correspond to this calculation.
   The notebook has additional commands to plot the results.
5. Uncertainty of equilibrium lattice constant and cohesive energy for a monolayer graphene at 0~K.
   Use `uncertainty_latconst_ecoh.ipynb` to do this calculation.
6. Uncertainty of energy as a function of lattice parameter for a monolayer graphene at 0~K under uniform in-plane compression and stretching.
   Use `uncertainty_energy_vs_latconst.ipynb` to do this calculation.
7. Uncertainty of phonon dispersion for a monolayer graphene at 0~K along $\Gamma - M - K - \Gamma$ band path.
   The phonon calculation in `uncertainty_phonon_dispersion.ipynb` is done using ASE.
8. Uncertainty of finite temperature virial stress of graphene at 300~K.
   The ensemble calculation is done using `uncertainty_virial_stress_runmd.py` Python script, and `uncertainty_virial_stress_submitjobs.py` is used to submit the jobs to the supercomputer.
   Then, use `uncertainty_virial_stress.ipynb` to present the results.
